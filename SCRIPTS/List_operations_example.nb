(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     12805,        424]
NotebookOptionsPosition[     10172,        332]
NotebookOutlinePosition[     11290,        368]
CellTagsIndexPosition[     11205,        363]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Cluster affinity test", "Title",
 CellChangeTimes->{{3.478480899223771*^9, 3.478480941382593*^9}, {
  3.478481018328113*^9, 3.478481028186508*^9}}],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\</Users/amanokou/SCRIPT-MATHEMATICA/SCRIPTS/List_operations.txt\>\""}]],\
 "Input",
 CellChangeTimes->{{3.4780656364195137`*^9, 3.4780656560226917`*^9}, {
  3.650013487220723*^9, 3.650013505773234*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cl1", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "5", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"7", ",", "8"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.478063727444051*^9, 3.478063742946126*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.478063745502787*^9, 3.478065621692959*^9, 
  3.478480949904603*^9, 3.650013511841453*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cl2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "5", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"7", ",", "8"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.4780637472059402`*^9, 3.478063770180643*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47806377069759*^9, 3.478065623349805*^9, 
  3.478480950010961*^9, 3.650013511888342*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cl3", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"5", ",", "6"}], "}"}], ",", 
    RowBox[{"{", "7", "}"}], ",", 
    RowBox[{"{", "8", "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.478064439853033*^9, 3.478064462086342*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", "7", "}"}], ",", 
   RowBox[{"{", "8", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.478065630259986*^9, 3.4784809500242*^9, 
  3.650013511939268*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cl11", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"8", ",", "7"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.478480963367846*^9, 3.478480985112413*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"8", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.478480986292749*^9, 3.650013511999131*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"clusterAffinity", "[", 
  RowBox[{"cl2", ",", "cl2"}], "]"}]], "Input",
 CellChangeTimes->{{3.478065275281815*^9, 3.478065278707672*^9}, {
  3.4780653949360447`*^9, 3.47806539863507*^9}, {3.4780654387877493`*^9, 
  3.47806543910394*^9}, {3.478065671237069*^9, 3.4780656714549503`*^9}, {
  3.478065840059712*^9, 3.478065845627077*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{{3.478065668692027*^9, 3.478065671671852*^9}, {
   3.478065840538287*^9, 3.4780658458337173`*^9}, 3.4784809887602873`*^9, 
   3.6500135120313463`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"clusterAffinitySq", "[", 
  RowBox[{"cl2", ",", "cl1"}], "]"}]], "Input",
 CellChangeTimes->{{3.478065275281815*^9, 3.478065278707672*^9}, {
  3.4780653949360447`*^9, 3.47806539863507*^9}, {3.4780654387877493`*^9, 
  3.47806543910394*^9}, {3.478065671237069*^9, 3.4780656823291407`*^9}, {
  3.478065835388475*^9, 3.478065850614626*^9}, {3.4784809927094793`*^9, 
  3.478480992988707*^9}}],

Cell[BoxData["0.8660254037844388`"], "Output",
 CellChangeTimes->{
  3.478065682887431*^9, {3.4780658358205423`*^9, 3.4780658507634563`*^9}, 
   3.478480993135107*^9, 3.6500135120862083`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"clusterAffinitySq", "[", 
  RowBox[{"cl11", ",", "cl1"}], "]"}]], "Input",
 CellChangeTimes->{{3.478065275281815*^9, 3.478065278707672*^9}, {
  3.4780653949360447`*^9, 3.47806539863507*^9}, {3.4780654387877493`*^9, 
  3.47806543910394*^9}, {3.478065671237069*^9, 3.4780656823291407`*^9}, {
  3.478065835388475*^9, 3.478065850614626*^9}, {3.4784809927094793`*^9, 
  3.4784809997337627`*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{3.478481000189123*^9, 3.650013512134945*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "clusterAffinitySq"}]], "Input",
 CellChangeTimes->{{3.478481062900667*^9, 3.478481065466014*^9}}],

Cell[CellGroupData[{

Cell["Global`clusterAffinitySq", "Print", "PrintUsage",
 CellChangeTimes->{3.650013512214704*^9},
 CellTags->"Info3650045912-9151474"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"clusterAffinitySq", "[", 
          RowBox[{"cl1_List", ",", "cl2_List"}], "]"}], ":=", 
         FractionBox[
          RowBox[{"clusterInner", "[", 
           RowBox[{"cl1", ",", "cl2"}], "]"}], 
          SqrtBox[
           RowBox[{
            RowBox[{"Length", "[", "cl1", "]"}], " ", 
            RowBox[{"Length", "[", "cl2", "]"}]}]]]}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`clusterAffinitySq],
  Editable->False]], "Print",
 CellChangeTimes->{3.650013512283926*^9},
 CellTags->"Info3650045912-9151474"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "clusterInnerSq"}]], "Input",
 CellChangeTimes->{{3.4784810776682663`*^9, 3.478481090903701*^9}}],

Cell[CellGroupData[{

Cell["Global`clusterInnerSq", "Print", "PrintUsage",
 CellChangeTimes->{3.650013512386746*^9},
 CellTags->"Info3650045912-9151474"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"clusterInnerSq", "[", 
          RowBox[{"cl1_List", ",", "cl2_List"}], "]"}], ":=", 
         RowBox[{"Tr", "[", 
          RowBox[{"Flatten", "[", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"N", "[", 
               RowBox[{"Outer", "[", 
                RowBox[{"intersectionNum", ",", "cl1", ",", "cl2", ",", "1"}],
                 "]"}], "]"}], 
              RowBox[{"Outer", "[", 
               RowBox[{"unionNum", ",", "cl1", ",", "cl2", ",", "1"}], "]"}]],
              ")"}], "2"], "]"}], "]"}]}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`clusterInnerSq],
  Editable->False]], "Print",
 CellChangeTimes->{3.650013512451692*^9},
 CellTags->"Info3650045912-9151474"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "intersectionNum"}]], "Input",
 CellChangeTimes->{{3.47848116334311*^9, 3.47848116703127*^9}}],

Cell[CellGroupData[{

Cell["Global`intersectionNum", "Print", "PrintUsage",
 CellChangeTimes->{3.6500135125560083`*^9},
 CellTags->"Info3650045912-9151474"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"intersectionNum", "[", "x___", "]"}], ":=", 
         RowBox[{"Length", "[", 
          RowBox[{"Intersection", "[", "x", "]"}], "]"}]}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`intersectionNum],
  Editable->False]], "Print",
 CellChangeTimes->{3.650013512597373*^9},
 CellTags->"Info3650045912-9151474"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{640, 750},
WindowMargins->{{292, Automatic}, {54, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (2014\:5e747\
\:67089\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3650045912-9151474"->{
  Cell[5996, 202, 134, 2, 49, "Print",
   CellTags->"Info3650045912-9151474"],
  Cell[6133, 206, 1108, 30, 67, "Print",
   CellTags->"Info3650045912-9151474"],
  Cell[7441, 248, 131, 2, 49, "Print",
   CellTags->"Info3650045912-9151474"],
  Cell[7575, 252, 1327, 35, 62, "Print",
   CellTags->"Info3650045912-9151474"],
  Cell[9099, 299, 134, 2, 49, "Print",
   CellTags->"Info3650045912-9151474"],
  Cell[9236, 303, 896, 24, 26, "Print",
   CellTags->"Info3650045912-9151474"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3650045912-9151474", 10702, 347}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 153, 2, 114, "Title"],
Cell[723, 26, 238, 5, 57, "Input"],
Cell[CellGroupData[{
Cell[986, 35, 347, 10, 35, "Input"],
Cell[1336, 47, 361, 10, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1734, 62, 374, 11, 35, "Input"],
Cell[2111, 75, 384, 11, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2532, 91, 397, 12, 35, "Input"],
Cell[2932, 105, 385, 12, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3354, 122, 348, 10, 35, "Input"],
Cell[3705, 134, 314, 9, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4056, 148, 358, 6, 36, "Input"],
Cell[4417, 156, 200, 3, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4654, 164, 411, 7, 36, "Input"],
Cell[5068, 173, 191, 3, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5296, 181, 414, 7, 36, "Input"],
Cell[5713, 190, 94, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5844, 196, 127, 2, 36, "Input"],
Cell[CellGroupData[{
Cell[5996, 202, 134, 2, 49, "Print",
 CellTags->"Info3650045912-9151474"],
Cell[6133, 206, 1108, 30, 67, "Print",
 CellTags->"Info3650045912-9151474"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7290, 242, 126, 2, 36, "Input"],
Cell[CellGroupData[{
Cell[7441, 248, 131, 2, 49, "Print",
 CellTags->"Info3650045912-9151474"],
Cell[7575, 252, 1327, 35, 62, "Print",
 CellTags->"Info3650045912-9151474"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8951, 293, 123, 2, 35, "Input"],
Cell[CellGroupData[{
Cell[9099, 299, 134, 2, 49, "Print",
 CellTags->"Info3650045912-9151474"],
Cell[9236, 303, 896, 24, 26, "Print",
 CellTags->"Info3650045912-9151474"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
